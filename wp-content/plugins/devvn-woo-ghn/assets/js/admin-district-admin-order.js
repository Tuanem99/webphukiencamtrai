!function(a){a(document).ready(function(){function i(){var b=14,c=53,d=62,e=a("body").hasClass("ghn_wrap_"+b+c+d);h=e?!1:!0}function j(b){0==b?(a("body").removeClass("ghn_loading"),i()):(a("body").addClass("ghn_loading"),i()),k()}function k(){var b=a(".ghn_PaymentTypeID:checked").val(),c=a("#ghn_tienthuho"),f=(a('body input[name="ghn_services"]:checked').data("fee"),a("#ghn_free_ship:checked").val()||0,c.data("codamount")||0);f?c.val(f):1==b?c.val(c.data("total")):2==b&&c.val(c.data("subtotal"))}accounting.settings={currency:{symbol:"\u0111",format:"%v %s",decimal:",",thousand:".",precision:0},number:{precision:0,thousand:".",decimal:","}},a.fn.extend({vnformat:function(b){var c;c="val"==b?a(this).val():a(this).text();var d="";return d=c.replace(/\xe0|\xe1|\u1ea1|\u1ea3|\xe3|\xe2|\u1ea7|\u1ea5|\u1ead|\u1ea9|\u1eab|\u0103|\u1eb1|\u1eaf|\u1eb7|\u1eb3|\u1eb5|\xc0|\xc1|\u1ea0|\u1ea2|\xc3|\xc2|\u1ea6|\u1ea4|\u1eac|\u1ea8|\u1eaa|\u0102|\u1eb0|\u1eae|\u1eb6|\u1eb2|\u1eb4/g,"a").replace(/\u0111|\u0110/g,"d").replace(/\u1ef3|\xfd|\u1ef5|\u1ef7|\u1ef9|\u1ef2|\xdd|\u1ef4|\u1ef6|\u1ef8/g,"y").replace(/\xf9|\xfa|\u1ee5|\u1ee7|\u0169|\u01b0|\u1eeb|\u1ee9|\u1ef1|\u1eed|\u1eef|\xd9|\xda|\u1ee4|\u1ee6|\u0168|\u01af|\u1eea|\u1ee8|\u1ef0|\u1eec|\u1eee/g,"u").replace(/\xf2|\xf3|\u1ecd|\u1ecf|\xf5|\xf4|\u1ed3|\u1ed1|\u1ed9|\u1ed5|\u1ed7|\u01a1|\u1edd|\u1edb|\u1ee3|\u1edf|\u1ee1|\xd2|\xd3|\u1ecc|\u1ece|\xd5|\xd4|\u1ed2|\u1ed0|\u1ed8|\u1ed4|\u1ed6|\u01a0|\u1edc|\u1eda|\u1ee2|\u1ede|\u1ee0/g,"o").replace(/\xe8|\xe9|\u1eb9|\u1ebb|\u1ebd|\xea|\u1ec1|\u1ebf|\u1ec7|\u1ec3|\u1ec5|\xc8|\xc9|\u1eb8|\u1eba|\u1ebc|\xca|\u1ec0|\u1ebe|\u1ec6|\u1ec2|\u1ec4/g,"e").replace(/\xec|\xed|\u1ecb|\u1ec9|\u0129|\xcc|\xcd|\u1eca|\xcc|\u0128/g,"i")}}),a.expr[":"].icontains=function(b,c,d){return a(b).vnformat().toUpperCase().indexOf(d[3].toUpperCase())>=0},a(".search_city").on("keyup",function(){var b=a(this).vnformat("val"),c=a(this).closest(".devvn_hubs_table");list=a(".ghn_all_state_checkbox_item",c),list.hide();var d=a(".ghn_all_state_checkbox_item label:icontains('"+b+"')",c);d.closest(".ghn_all_state_checkbox_item").find(".ghn_all_state_checkbox_item").andSelf().show()});var b={formatNoMatches:admin_ghn_array.formatNoMatches},c=loading_shipping=!1;a("#_billing_state").select2(b),a("#_billing_city").select2(b),a("body #_billing_state").live("select2:select",function(b){console.log("a"),a("#_billing_city option").val("");var d=b.val;d||(d=a("body #_billing_state option:selected").val()),d&&!c&&(c=!0,a.ajax({type:"post",dataType:"json",url:admin_ghn_array.ajaxurl,data:{action:"load_diagioihanhchinh",matp:d},context:this,beforeSend:function(){a("#_billing_city").html("").select2();var b=new Option("Loading...","");a("#_billing_city").append(b)},success:function(b){c=!1,a("#_billing_city").html("").select2();var d=new Option("Ch\u1ecdn x\xe3/ph\u01b0\u1eddng/th\u1ecb tr\u1ea5n","");if(b.success){var e=b.data;d=new Option("Ch\u1ecdn qu\u1eadn/huy\u1ec7n",""),a("#_billing_city").append(d),a.each(e,function(b,c){d=new Option(c.WardName,c.WardCode),a("#_billing_city").append(d)})}}}))}),a("#_shipping_state").select2(b),a("#_shipping_city").select2(b),a("body #_shipping_state").live("select2:select",function(b){a("#_shipping_city option").val("");var c=b.val;c||(c=a("#_shipping_state option:selected").val()),c&&!loading_shipping&&(loading_shipping=!0,a.ajax({type:"post",dataType:"json",url:admin_ghn_array.ajaxurl,data:{action:"load_diagioihanhchinh",matp:c},context:this,beforeSend:function(){a("#_shipping_city").html("").select2();var b=new Option("Loading...","");a("#_shipping_city").append(b)},success:function(b){loading_shipping=!1,a("#_shipping_city").html("").select2();var c=new Option("Ch\u1ecdn x\xe3/ph\u01b0\u1eddng/th\u1ecb tr\u1ea5n","");if(b.success){var d=b.data,c=new Option("Ch\u1ecdn qu\u1eadn/huy\u1ec7n","");a("#_shipping_city").append(c),a.each(d,function(b,c){var d=new Option(c.WardName,c.WardCode);a("#_shipping_city").append(d)})}}}))}),a(".hub_DistrictID").length>0&&a(".hub_DistrictID").select2();var e=!1;a(".devvn_ghn_updatehubs").on("click",function(){if(!e){var b=a(this).closest(".devvn_hubs_table"),c={},d=a('[class^="hub_"]',b);d.each(function(){a(this).is("select")?c[a(this).data("name")]=a("option:selected",this).val():"checkbox"==a(this).prop("type")?a(this).is(":checked")&&(c[a(this).data("name")]=a(this).val()):c[a(this).data("name")]=a(this).val()});var f=a("#nonce_update").val();a.ajax({type:"post",dataType:"json",url:admin_ghn_array.ajaxurl,data:{action:"update_hubs",data:c,nonce:f},context:this,beforeSend:function(){a(".spinner",b).addClass("is-active"),e=!0},success:function(c){c.success?location.reload():alert(c.data),a(".spinner",b).removeClass("is-active"),e=!1}})}return!1});var f=!1;a(".devvn_ghn_addhubs").on("click",function(){if(!f){var b=a(this).closest(".devvn_hubs_table"),c={},d=a('[class^="hub_"]',b);d.each(function(){a(this).is("select")?c[a(this).data("name")]=a("option:selected",this).val():"checkbox"==a(this).prop("type")?a(this).is(":checked")&&(c[a(this).data("name")]=a(this).val()):c[a(this).data("name")]=a(this).val()});var e=a("#nonce_add").val();a.ajax({type:"post",dataType:"json",url:admin_ghn_array.ajaxurl,data:{action:"add_hubs",data:c,nonce:e},context:this,beforeSend:function(){a(".spinner",b).addClass("is-active"),a(".ghn_msg",b).html(""),f=!0},success:function(c){c.success?(a(".ghn_msg",b).html(c.data),location.reload()):alert(c.data),a(".spinner",b).removeClass("is-active"),f=!1}})}return!1}),a(".devvn_ghn_addhub").on("click",function(){return a(".add_hub_popup").bPopup({closeClass:"close_popup"}),a(".hub_DistrictID").length>0&&a(".hub_DistrictID").select2(),!1}),a(".khuvuc_banhang").on("click",function(){var b=a(this).data("hubid");return a("#hub_district_"+b).bPopup({closeClass:"close_popup"}),!1});var g=!1;a(".devvn_ghn_addhubdistrict").on("click",function(){if(g)return!1;var b=a(this).closest("table.devvn_hubs_table"),c=a(this).data("hubid"),d=a("#nonce_update").val(),e=[];return a('input[name="hubs_district_'+c+'"]').each(function(){a(this).is(":checked")&&e.push(a(this).val())}),a.ajax({type:"post",dataType:"json",url:admin_ghn_array.ajaxurl,data:{action:"add_hubdistrict",hubid:c,districtID:e,nonce:d},context:this,beforeSend:function(){g=!0,a(".spinner",b).addClass("is-active"),a(".ghn_msg",b).html("")},success:function(c){c.success?a(".ghn_msg",b).html(c.data):alert(c.data),setTimeout(function(){a(".ghn_msg",b).fadeOut(400,function(){a(this).html("")})},3e3),a(".spinner",b).removeClass("is-active"),g=!1},error:function(){a(".spinner",b).removeClass("is-active"),a(".ghn_msg",b).html(""),g=!1}}),!1}),a(".devvn_checkbox_all").on("click",function(){var b=a(this).closest("table");return a('input[type="checkbox"]:checked',b).length>0?a('input[type="checkbox"]',b).prop("checked",!1):a('input[type="checkbox"]',b).prop("checked",!0),!1}),a("body").on("change click",'input[name="ghn_services"]',function(){var b=a(".ghn_all_phuphi"),c=a(".ghn_all_phuphi_list",b);b.removeClass("ghn_show");var d=a(this).closest(".ghn_all_goicuoc_list"),e=d.data("extras");if(e.length>0){var f="";a(e).each(function(a,b){f+='<div class="ghn_all_goicuoc_list">',f+='<div class="ghn_all_goicuoc_col"><label><input type="checkbox" name="ghn_extras[]" value="'+b.ServiceID+'"> '+b.Name+" ("+accounting.formatMoney(b.ServiceFee)+")</label></div>",f+="</div>"}),b.addClass("ghn_show"),c.html(f)}k()});var h=!1;i(),a(".ghn_creat_order_popup, .ghn_update_order").on("click",function(){return a(".ghn_creat_popup").bPopup({closeClass:"close_popup"}),a("#ghn_customer_infor_khuvuc").length>0&&a("#ghn_customer_infor_khuvuc").select2(),a("#ghn_customer_infor_ward").length>0&&a("#ghn_customer_infor_ward").select2(),a("#ghn_creatorder_hub").length>0&&a("#ghn_creatorder_hub").select2(),a("#ghn_ghichu_required").length>0&&a("#ghn_ghichu_required").select2(),a('body input[name="ghn_services"]:checked').trigger("click"),!1}),a("#ghn_creatorder_hub").on("select2:select",function(b){var c=b.params.data.id,d=a("#ghn_action_nonce").val(),e=a("#post_ID").val(),f=a(".ghn_all_goicuoc"),g=a(".ghn_all_phuphi_list"),i=a(".ghn_all_phuphi");return h||a.ajax({type:"post",dataType:"json",url:admin_ghn_array.ajaxurl,data:{action:"ghn_change_hub",hubid:c,order_id:e,nonce:d},context:this,beforeSend:function(){j()},success:function(a){g.html(""),i.removeClass("ghn_show"),a.success?f.html(a.data):(f.html(""),alert(a.data)),j(!1)},error:function(){j(!1),f.html(""),g.html(""),i.removeClass("ghn_show")}}),!1}),a(".devvn_ghn_creat_order, .devvn_ghn_update_order").on("click",function(){var b=a("#ghn_ShippingOrderID").val()||0,c=a("#ghn_OrderCode").val()||0,d=a(this).closest("tr"),e=a("#ghn_action_nonce").val(),f=a("#post_ID").val(),g=a(".ghn_PaymentTypeID:checked").val(),i=a("#ghn_creatorder_hub").val(),k=a("#ghn_ghichu").val(),l=a("#ghn_tienthuho").val(),m=a("#ghn_ghichu_required").val(),n=a("#ghn_InsuranceFee").val(),o=a('input[name="ghn_services"]:checked').val();if(!o)return alert("H\xe3y ch\u1ecdn d\u1ecbch v\u1ee5 giao h\xe0ng!"),!1;var p=a("#ghn_contentOrder").val(),q=a("#ghn_CouponCode").val(),r=a("#ghn_order_weight").val(),s=a("#ghn_order_length").val(),t=a("#ghn_order_width").val(),u=a("#ghn_order_height").val(),v=a(".ghn_isPickAtStation:checked").val(),w=[];a('input[name="ghn_extras[]"]:checked').each(function(b){w[b]=a(this).val()}),1==v&&w.push("53337");var x="ghn_creat_order";return b&&c&&(x="ghn_update_order"),h||a.ajax({type:"post",dataType:"json",url:admin_ghn_array.ajaxurl,data:{action:x,post_ID:f,ghn_ShippingOrderID:b,ghn_OrderCode:c,PaymentTypeID:g,hubID:i,noteOrder:k,CoDAmount:l,noteCode:m,nonce:e,InsuranceFee:n,ghn_services:o,ghn_contentOrder:p,ghn_CouponCode:q,ghn_order_weight:r,ghn_order_length:s,ghn_order_width:t,ghn_order_height:u,ghn_extras:w},context:this,beforeSend:function(){a(".ghn_msg",d).html(""),j()},success:function(b){if(b.success)a(".ghn_msg",d).html(b.data),location.reload();else{var c=b.data;alert(c.replace(/\\n/g,"\n"))}j(!1)},error:function(){a(".ghn_msg",d).html(""),j(!1)}}),!1}),a(".ghn_PaymentTypeID, #ghn_free_ship").on("change click",function(){k()}),a("body").on("click",".ghn_cancel_order",function(){var b=a(this).data("ordercode"),c=a("#ghn_action_nonce").val(),d=a("#post_ID").val();return h||a.ajax({type:"post",dataType:"json",url:admin_ghn_array.ajaxurl,data:{action:"ghn_cancel_order",ordercode:b,post_ID:d,nonce:c},context:this,beforeSend:function(){j()},success:function(a){var b=a.data;a.success?(alert(b.replace(/\\n/g,"\n")),location.reload()):alert(b.replace(/\\n/g,"\n")),j(!1)},error:function(){j(!1)}}),!1}),a(".ghn_tracking_order").on("click",function(){var b=a(this).data("ordercode"),c=a("#ghn_action_nonce").val(),d=a("#post_ID").val();return h||a.ajax({type:"post",dataType:"json",url:admin_ghn_array.ajaxurl,data:{action:"ghn_tracking_order",ordercode:b,post_ID:d,nonce:c},context:this,beforeSend:function(){j()},success:function(a){var b=a.data;alert(a.success?b.replace(/\\n/g,"\n"):b.replace(/\\n/g,"\n")),j(!1)},error:function(){j(!1)}}),!1})})}(jQuery);